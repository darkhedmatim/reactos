#!/bin/sh -xv

reactos-powerpc-ld \
    -v \
    --subsystem native \
    --entry NtProcessStartup \
    --image-base 0x80000000 \
    --file-alignment 0x1000 \
    --section-alignment 0x1000 \
    -nostartfiles -shared \
    ntoskrnl.temp.exp -o output-ppc/ntoskrnl/ntoskrnl.exe \
    obj-ppc/ntoskrnl/ke/powerpc/main_asm.o \
    obj-ppc/ntoskrnl/ke/apc.o \
    obj-ppc/ntoskrnl/ke/bug.o \
    obj-ppc/ntoskrnl/ke/clock.o \
    obj-ppc/ntoskrnl/ke/device.o \
    obj-ppc/ntoskrnl/ke/dpc.o \
    obj-ppc/ntoskrnl/ke/event.o \
    obj-ppc/ntoskrnl/ke/exception.o \
    obj-ppc/ntoskrnl/ke/gate.o \
    obj-ppc/ntoskrnl/ke/gmutex.o \
    obj-ppc/ntoskrnl/ke/ipi.o \
    obj-ppc/ntoskrnl/ke/kqueue.o \
    obj-ppc/ntoskrnl/ke/kthread.o \
    obj-ppc/ntoskrnl/ke/mutex.o \
    obj-ppc/ntoskrnl/ke/process.o \
    obj-ppc/ntoskrnl/ke/profile.o \
    obj-ppc/ntoskrnl/ke/queue.o \
    obj-ppc/ntoskrnl/ke/sem.o \
    obj-ppc/ntoskrnl/ke/spinlock.o \
    obj-ppc/ntoskrnl/ke/timer.o \
    obj-ppc/ntoskrnl/ke/usercall.o \
    obj-ppc/ntoskrnl/ke/wait.o \
    obj-ppc/ntoskrnl/cc/cacheman.o \
    obj-ppc/ntoskrnl/cc/copy.o \
    obj-ppc/ntoskrnl/cc/fs.o \
    obj-ppc/ntoskrnl/cc/mdl.o \
    obj-ppc/ntoskrnl/cc/pin.o \
    obj-ppc/ntoskrnl/cc/view.o \
    obj-ppc/ntoskrnl/cm/import.o \
    obj-ppc/ntoskrnl/cm/ntfunc.o \
    obj-ppc/ntoskrnl/cm/regfile.o \
    obj-ppc/ntoskrnl/cm/registry.o \
    obj-ppc/ntoskrnl/cm/regobj.o \
    obj-ppc/ntoskrnl/dbgk/dbgkutil.o \
    obj-ppc/ntoskrnl/dbgk/debug.o \
    obj-ppc/ntoskrnl/ex/atom.o \
    obj-ppc/ntoskrnl/ex/callback.o \
    obj-ppc/ntoskrnl/ex/dbgctrl.o \
    obj-ppc/ntoskrnl/ex/error.o \
    obj-ppc/ntoskrnl/ex/event.o \
    obj-ppc/ntoskrnl/ex/evtpair.o \
    obj-ppc/ntoskrnl/ex/fmutex.o \
    obj-ppc/ntoskrnl/ex/handle.o \
    obj-ppc/ntoskrnl/ex/init.o \
    obj-ppc/ntoskrnl/ex/lookas.o \
    obj-ppc/ntoskrnl/ex/mutant.o \
    obj-ppc/ntoskrnl/ex/power.o \
    obj-ppc/ntoskrnl/ex/pushlock.o \
    obj-ppc/ntoskrnl/ex/profile.o \
    obj-ppc/ntoskrnl/ex/resource.o \
    obj-ppc/ntoskrnl/ex/rundown.o \
    obj-ppc/ntoskrnl/ex/sem.o \
    obj-ppc/ntoskrnl/ex/sysinfo.o \
    obj-ppc/ntoskrnl/ex/time.o \
    obj-ppc/ntoskrnl/ex/timer.o \
    obj-ppc/ntoskrnl/ex/uuid.o \
    obj-ppc/ntoskrnl/ex/win32k.o \
    obj-ppc/ntoskrnl/ex/work.o \
    obj-ppc/ntoskrnl/ex/zone.o \
    obj-ppc/ntoskrnl/ex/zw.o \
    obj-ppc/ntoskrnl/fs/context.o \
    obj-ppc/ntoskrnl/fs/fastio.o \
    obj-ppc/ntoskrnl/fs/filelock.o \
    obj-ppc/ntoskrnl/fs/mcb.o \
    obj-ppc/ntoskrnl/fs/name.o \
    obj-ppc/ntoskrnl/fs/notify.o \
    obj-ppc/ntoskrnl/fs/oplock.o \
    obj-ppc/ntoskrnl/fs/pool.o \
    obj-ppc/ntoskrnl/fs/tunnel.o \
    obj-ppc/ntoskrnl/fs/unc.o \
    obj-ppc/ntoskrnl/fs/util.o \
    obj-ppc/ntoskrnl/inbv/inbv.o \
    obj-ppc/ntoskrnl/io/iomgr/*.o \
    obj-ppc/ntoskrnl/io/pnpmgr/*.o \
    obj-ppc/ntoskrnl/kd/wrappers/bochs.o \
    obj-ppc/ntoskrnl/kd/wrappers/gdbstub.o \
    obj-ppc/ntoskrnl/kd/kdinit.o \
    obj-ppc/ntoskrnl/kd/kdio.o \
    obj-ppc/ntoskrnl/kd/kdmain.o \
    obj-ppc/ntoskrnl/ldr/loader.o \
    obj-ppc/ntoskrnl/ldr/rtl.o \
    obj-ppc/ntoskrnl/lpc/close.o \
    obj-ppc/ntoskrnl/lpc/complete.o \
    obj-ppc/ntoskrnl/lpc/connect.o \
    obj-ppc/ntoskrnl/lpc/create.o \
    obj-ppc/ntoskrnl/lpc/listen.o \
    obj-ppc/ntoskrnl/lpc/port.o \
    obj-ppc/ntoskrnl/lpc/query.o \
    obj-ppc/ntoskrnl/lpc/queue.o \
    obj-ppc/ntoskrnl/lpc/receive.o \
    obj-ppc/ntoskrnl/lpc/reply.o \
    obj-ppc/ntoskrnl/lpc/send.o \
    obj-ppc/ntoskrnl/mm/anonmem.o \
    obj-ppc/ntoskrnl/mm/aspace.o \
    obj-ppc/ntoskrnl/mm/balance.o \
    obj-ppc/ntoskrnl/mm/cont.o \
    obj-ppc/ntoskrnl/mm/drvlck.o \
    obj-ppc/ntoskrnl/mm/freelist.o \
    obj-ppc/ntoskrnl/mm/iospace.o \
    obj-ppc/ntoskrnl/mm/kmap.o \
    obj-ppc/ntoskrnl/mm/marea.o \
    obj-ppc/ntoskrnl/mm/mdl.o \
    obj-ppc/ntoskrnl/mm/mm.o \
    obj-ppc/ntoskrnl/mm/process.o \
    obj-ppc/ntoskrnl/mm/mminit.o \
    obj-ppc/ntoskrnl/mm/mpw.o \
    obj-ppc/ntoskrnl/mm/ncache.o \
    obj-ppc/ntoskrnl/mm/npool.o \
    obj-ppc/ntoskrnl/mm/pagefile.o \
    obj-ppc/ntoskrnl/mm/pageop.o \
    obj-ppc/ntoskrnl/mm/pager.o \
    obj-ppc/ntoskrnl/mm/pagfault.o \
    obj-ppc/ntoskrnl/mm/paging.o \
    obj-ppc/ntoskrnl/mm/pe.o \
    obj-ppc/ntoskrnl/mm/physical.o \
    obj-ppc/ntoskrnl/mm/pool.o \
    obj-ppc/ntoskrnl/mm/ppool.o \
    obj-ppc/ntoskrnl/mm/region.o \
    obj-ppc/ntoskrnl/mm/rmap.o \
    obj-ppc/ntoskrnl/mm/section.o \
    obj-ppc/ntoskrnl/mm/verifier.o \
    obj-ppc/ntoskrnl/mm/virtual.o \
    obj-ppc/ntoskrnl/mm/wset.o \
    obj-ppc/ntoskrnl/mm/elf32.o \
    obj-ppc/ntoskrnl/mm/elf64.o \
    obj-ppc/ntoskrnl/ob/obdir.o \
    obj-ppc/ntoskrnl/ob/obinit.o \
    obj-ppc/ntoskrnl/ob/obhandle.o \
    obj-ppc/ntoskrnl/ob/obname.o \
    obj-ppc/ntoskrnl/ob/oblife.o \
    obj-ppc/ntoskrnl/ob/obref.o \
    obj-ppc/ntoskrnl/ob/sdcache.o \
    obj-ppc/ntoskrnl/ob/symlink.o \
    obj-ppc/ntoskrnl/po/power.o \
    obj-ppc/ntoskrnl/ps/*.o \
    obj-ppc/ntoskrnl/rtl/libsupp.o \
    obj-ppc/ntoskrnl/rtl/misc.o \
    obj-ppc/ntoskrnl/rtl/nls.o \
    obj-ppc/ntoskrnl/rtl/regio.o \
    obj-ppc/ntoskrnl/rtl/strtok.o \
    obj-ppc/ntoskrnl/se/access.o \
    obj-ppc/ntoskrnl/se/acl.o \
    obj-ppc/ntoskrnl/se/audit.o \
    obj-ppc/ntoskrnl/se/lsa.o \
    obj-ppc/ntoskrnl/se/luid.o \
    obj-ppc/ntoskrnl/se/priv.o \
    obj-ppc/ntoskrnl/se/sd.o \
    obj-ppc/ntoskrnl/se/semgr.o \
    obj-ppc/ntoskrnl/se/sid.o \
    obj-ppc/ntoskrnl/se/token.o \
    obj-ppc/ntoskrnl/ntoskrnl.coff \
    obj-ppc/ntoskrnl/kdbg/kdb_symbols.o \
    obj-ppc/lib/drivers/csq/csq.a \
    obj-ppc/hal/hal/libhal.a \
    obj-ppc/lib/kjs/kjs.a \
    obj-ppc/lib/pseh/pseh.a \
    obj-ppc/lib/rtl/rtl.a \
    obj-ppc/lib/rossym/rossym.a \
    obj-ppc/lib/string/string.a \
    obj-ppc/lib/wdmguid/wdmguid.a \
    -nostartfiles \
    -nostdlib \
    -lgcc  -g
