DEFS      = -DINCLUDEDIR="\"$(includedir)\""
TOPSRCDIR = @top_srcdir@
TOPOBJDIR = ../..
SRCDIR    = @srcdir@
VPATH     = @srcdir@
LEXOPT    = -Cf #-w -b
EXEEXT    = @EXEEXT@

PROGRAMS = wrc$(EXEEXT)
MANPAGES = wrc.man
MODULE   = none

C_SRCS = \
	dumpres.c \
	genres.c \
	newstruc.c \
	readres.c \
	translation.c \
	utils.c \
	wrc.c \
	writeres.c

EXTRA_SRCS = parser.y parser.l
EXTRA_OBJS = parser.tab.o @LEX_OUTPUT_ROOT@.o

all: $(PROGRAMS) $(MANPAGES)

@MAKE_RULES@

wrc$(EXEEXT): $(OBJS) $(LIBDIR)/wpp/libwpp.a
	$(CC) $(CFLAGS) -o $@ $(OBJS) -L$(LIBDIR) -lwpp -lwine_unicode -lwine_port $(LEXLIB) $(LDFLAGS)

parser.tab.c parser.tab.h: parser.y
	$(BISON) -d -t $(SRCDIR)/parser.y -o parser.tab.c

# hack to allow parallel make
parser.tab.h: parser.tab.c
parser.tab.o: parser.tab.h

@LEX_OUTPUT_ROOT@.c: parser.l
	$(LEX) $(LEXOPT) -d -8 $(SRCDIR)/parser.l

@LEX_OUTPUT_ROOT@.o: parser.tab.h

install:: $(PROGRAMS) $(MANPAGES)
	$(MKINSTALLDIRS) $(bindir) $(mandir)/man$(prog_manext)
	$(INSTALL_DATA) wrc.man $(mandir)/man$(prog_manext)/wrc.$(prog_manext)
	$(INSTALL_PROGRAM) wrc$(EXEEXT) $(bindir)/wrc$(EXEEXT)

uninstall::
	$(RM) $(bindir)/wrc$(EXEEXT) $(mandir)/man$(prog_manext)/wrc.$(prog_manext)

### Dependencies:
